# Welcome to Tanstack Start + Convex

Simple starter for Tanstack and Convex. Also implements Auth using convex OAuth.

**Includes:**
- ðŸ–ï¸ Tanstack Start - Router & Query
- ðŸš§ Convex - DB, Sync, and Auth
- ðŸŽ¨ TailwindCSS - Styling
- ðŸ“„ Ultracite - Formatting & Linting
- ðŸ–¼ï¸ Lucide Icons - SVG icons

## Get started

``` bash
flox activate
npm run dev
```

### Authentication

In the starter kit only github OAuth authentication is used. This needs little bit of setup before it works.

You have to create a Github OAuth app from the following link: [Link](https://github.com/settings/applications/new)

`Homepage URL` should be http://localhost:3000
`Authorization callback URL` is the `HTTP Actions URL` and can be found in the `Settings` -> `URL & Deploy key`.

Once the app has been created you have to add couple env variables to your convex instance:
```
npx convex env set AUTH_GITHUB_ID <GITHUB_CLIENT_ID>
npx convex env set AUTH_GITHUB_SECRET <GITHUB_SECRET>
```

> [!NOTE]  
> The env variables can also be configured from the convex dashboard `Settings` -> `Environment variables`

## Deployment

In server `env` set the following variables:

```
VITE_CONVEX_URL='https://<your-backend-url>'
```

`VITE_CONVEX_URL` can be found from the convex dashboard under `Settings` -> `URL & Deploy key`

### Self hosted authentication

To get authentication working we need to set couple env variables in the convex instance.

- `JWKS`
- `JWT_PRIVATE_KEY`
- `SITE_URL`

These can be easily generated by running `npx @convex-dev/auth`. You will need to set the URL of the domain you host the site in and then the tool will auto generate the needed env variables and save them to the local convex instance. Then you will need to copy them to the self hosted instance.

> [!IMPORTANT]  
> Once the variables have been copied to the self hosted instance you should delete the generated env variables from the local dev convex instance and generate new ones to improve security!

For more information look at [Set Up Convex Auth](https://labs.convex.dev/auth/setup)

> [!IMPORTANT]  
> You should also follow the `Authentication` section in the Get started part of the guide

## Development against self hosted instance

To develop against a self hosted convex instance set following `env` variables:

```
CONVEX_SELF_HOSTED_URL='https://<your-backend-url>'
CONVEX_SELF_HOSTED_ADMIN_KEY='<your admin key>'
```

`CONVEX_SELF_HOSTED_URL` can be found from the convex dashboard under `Settings` -> `URL & Deploy key`

`CONVEX_SELF_HOSTED_ADMIN_KEY` can be generated in the convex backend container using the generate_admin_key.sh script